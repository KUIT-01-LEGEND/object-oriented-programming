# 4장

## 요약(~~3줄도 필요 없음~~)
1. 객체지향 설계는 시스템의 책임(=기능)을 위해 협력해야할 때 어떤 객체들이 필요하고, 그 객체들에게 어떤 책임(=행동, 추상화하면 역할)을 부여해야 하는지 정하는 것이다.

*인사이트* 
- 그 객체를 사실적으로 표현하는 것은 중요하지 않다(1장에서 말했단 실제 세계를 옮긴다거나, 계속 얘기하는 것처럼 클래스나 상태부터 고민해서 그 객체의 어떤 모습을 표현하는 것)
<br> 왜냐하면 우리의 목적은 시스템의 책임(=기능)을 다하는 것이고, 이를 위해서 무엇을 해야하는가의 관점(= 책에서 말하는 협력의 문맥)에서 봐야하기 때문이다.
<br> 이렇게 우리의 목적에 집중해서 바라보면 그 객체의 사실적인 특징(왕 객체에서, 왕의 키나 수염길이 등)은 하등 쓸모가 없는 요소가 된다.
<br> 그러니까 우리의 목적을 위해서는 이 목적 달성을 위한 협력 속에서 객체가 어떤 행동을 할 지 그것만이 중요한 것이다.


## 협력이란 문맥
최후통첩 게임 예시(~~비문학 생각남~~)

객체는 협력이라는 문맥 안에 존재한다. 그리고 그 문맥이 객체의 행동(=책임)을 좌우한다.

중요한 것은 객체 사이에 이뤄지는 협력이며, 객체 그 자체부터 본다거나 객체 그 자체에 대한 의미는 거의 없다.

심지어 객체만 따로 떼어내고 보면 좀 기형적인 애들도 있음.

협력의 품질(후에 나옴)이 중요하다

## 협력이란?
공통의 목적을 위해서 각자의 책임을 다하는 것.

재판의 예시

각자의 책임을 요구하기 위해 요청, 응답을 이용.

## 책임
수신자에 대한 요청은 곧 그 행동을 할 책임이 있는 수신자임을 의미함.

중요한 것은 어떻게 객체들에게 책임을 분배할까이지("무엇을), 책임을 "어떻게" 구현할까는 아니다.

책임을 "아는 것", "하는 것"으로 분리된다.

하는 것
- 객체를 생성하거나, 계산을 하는 것
- 다른 객체의 행동을 시작시키는 것
- 다른 객체의 활동을 제어, 조율하는 것

아는 것
- 개인적인 정보에 대해 아는 것
- 관련된 객체에 대해 아는 것
- 자신이 유도하거나 계산할 수 있는 것에 대해 아는 것

책임 = 객체의 외부에 제공할 수 있는 정보(아는 것)와 서비스(하는 것)의 목록

-> 공용 인터페이스와 관련

## 메시지, 책임
책임은 수신자의 역할을 강조한 단어라면

메시지는 송신자, 수신자 간의 협력 관계를 강조한 단어

책임과 메시지의 수준이 같지는 않음. 책임이 좀 더 추상적임.

하나의 책임을 여러 개의 메시지로 분할하는 것이 일반적

객체지향 설계란, 협력을 위해 
1. 어떤 객체가 어떤 책임을 수행해야하는 지
2. 어떤 객체로부터 메시지를 수신할 것인지

를 정하는 것

## 역할
책임을 모아놓으면 그게 역할이 됨(책임의 집합 = 역할)

역할은 협력이란 문맥 속에서 재사용 가능한 추상적 요소임.

그 역할을 수행할 수 있다면, 어떤 객체든 상관없음 = 대체가능성

역할을 책임을 추상적으로 표현했기 때문에,

역할을 이용하면 협력을 추상화할 수 있음(협력의 추상화)

같은 역할을 할 수 있는, 대체 가능한 객체는 그 역할이 가지는 책임을 수행하기 위한 메시지를 이해할 수 있어야 함.

같은 역할을 할 수 있다 = 같은 책임의 집합을 수행할 수 있다 = 같은 메시지의 집합을 이해하고 처리할 수 있다 = 같은 행동의 집합을 수행할 수 있다

개별적인 객체는 그 역할 이상의 책임을 수행할 수도 있음(이현희 = 아들이자 형)

따라서 객체의 타입은 특수화, 객체의 역할을 일반화 관계가 성립함

## 객체지향에 대한 오해
1. 객체가 존재하는 이유는 데이터를 저장하기 위해서이다.
2. 객체지향은 정적인 측면(클래스)에 집중해야 한다.

사실은,

1. 객체는 행동을 통해 협력에 참여하기 위해서 존재한다.
2. 객체지향은 협력 속에서 동적으로 참여하며 어떤 책임을 담당할 것인가에 집중해야한다.

왕이 어떻게 생겼고 무엇을 할 수 있는지부터 고민할 필요가 없다.

궁극적으로 이루고자 하는 것은 협력을 통한 시스템의 책임을 다하는 것이기 때문에,

그 협력 속에서 왕이 무엇을 할 수 있는지가 중요할 뿐. 그 이외에는 필요가 없음.

## 협력이라는 문맥을 통한 설계
협력을 설계 한다 = 설계에 참여하는 객체들이 주고받을 요청, 응답의 흐름을 정한다. = 설계에 참여하는 객체들의 책임을 정한다

객체의 책임 = 외부에 제공할 행동

1. 객체들의 메시지를 정함
2. 그 메시지에 대한 행동 즉 책임이 정해짐
3. 행동을 수행하는데 필요한 데이터를 정함

## 객체지향 설계기법
객체지향 설계를 위한 기법 3가지 
1. 책임 주도 설계
<br> 협력에 필요한 객체 식별 -> 적절한 객체에게 적절한 책임 할당
2. 디자인 패턴
<br> 책임 주도 설계의 결과물의 모음
3. 테스트 주도 개발
<br> 테스트 작성이 중요한 것이 아니고 설계를 위한 기법.
<br> 구체적인 코드 속에서 협력, 역할, 책임을 식별하고 피드백 받기 위한 방법

### 1. 책임 주도 설계
객체지향 설계의 핵심은 협력 속의 객체를 식별하고 적절한 객체에게 적절한 책임을 부여하는 것.

이를 위한 가이드라인이 바로 책임 주도 설계

시스템의 기능 -> 더 작은 규모의 책임으로 분할 -> 책임을 적절한 객체에게 할당

책임 수행 중 스스로 처리 불가능하면 적절한 객체에게 요청(=책임 위임)

해당 책임을 여러 종류의 객체가 수행 가능하면(=다형성) 이 책임은 "역할"로 추상화 됨.

### 2. 디자인 패턴
best practice의 모음

현명하다면, 이전의 결과물들을 활용할 수 있어야 한다.

패턴은 특정한 상황에서 왜 어떤 설계가 더 좋은 지를 설명한다.

COMPOSITE 패턴 - 전체와 부분을 같은 인터페이스로 추상화

-> 윈도우 폴더 탐색기와 유사. 파일과 폴더를 같은 인터페이스(추가, 삭제, 이동 등)로 추상화

COMPOSITE 패턴의 세부적인 구조가 아니고 전체적인 그림을 봐야함

어떤 협력의 맥락에서 어떤 역할과 책임이 있는지를 봐야함

하나로 합쳐버린 예제처럼 디자인 패턴은 유연하게 적용할 수 있음. 무조건 저 구조가 그대로 클래스, 인터페이스로 구현되는 것이 아님.

### 3. 테스트 주도 개발
TDD는 초보자가 까불면 안된다

테스트를 작성하는 것이 아니라, "책임을 수행할 객체(또는 클라이언트)"가 /

"기대하는 객체"의 역할이 메시지를 수신할 때 어떤 결과를 반환하고 그 과정에서 어떤 객체화 협력할 지에 대한 기대를 코드의 형태로 작성하는 것

테스트 주도 개발은 책임 주도 설계를 통해 도달해야할 "목적지"를

테스트라는 안전장치를 통해 좀 더 빠르게 견고하게 도달할 수 있게 해주는 방법

객체의 메소드를 호출하고, 반환값을 검증하는 것은 객체의 책임에 관해 다루는 것(책임을 담당하고, 책임을 잘 처리하는 지)

목 객체나 스텁을 추가하는 것은 협력자에 대한 고민을 코드에 표현한 것 *스텁이 뭐지?*
